---
title: Аутентификация пользователей
atype: GEN
---

Задача состоит в том, чтобы определить пользователя не используя Cookie. В самом простом случае мы бы могли отправить `Set-Cookie` с полями ID, и задать точный ID пользователю. В нашем случае флоу будет следующий:

<br> 

![Диаграмма аутентификации пользователей](/architecture/gen-user-auth/Auth.drawio.png)

Таким образом получается что:
1. У каждого пользователя при переходе на сайт генерируется один user_id на всегда (по крайней мере для одного браузера, большего нам и не надо)
2. У каждого пользователя есть временный токен, по которому мы будем определять с какой комнаты сам пользователь
3. Сам токен не будет долго жить, каждую сессию браузера он меняется

С помощью токена пользователь может переподключиться к комнате или отключиться от нее с помощью API (помним, что для отключения от комнаты нужны не только `room_uuid` и `user_id`, но еще и `token`).

Все ID пользователей будут храниться в обычном счетчике, для этого в БД выделена коллекция `Counter`, которая подсчитывает ID комнат, а теперь и пользователей.